<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Spectra Data Processor</title>
        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            body {
                font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
                line-height: 1.6;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                min-height: 100vh;
                padding: 20px;
            }

            .container {
                max-width: 1400px;
                margin: 0 auto;
                background: white;
                border-radius: 15px;
                box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
                overflow: hidden;
            }

            header {
                background: linear-gradient(135deg, #2c3e50 0%, #4a6491 100%);
                color: white;
                padding: 40px;
                text-align: center;
            }

            h1 {
                font-size: 2.8em;
                margin-bottom: 10px;
                font-weight: 300;
            }

            .subtitle {
                font-size: 1.2em;
                opacity: 0.9;
                font-weight: 300;
            }

            .main-content {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 30px;
                padding: 40px;
            }

            @media (max-width: 1100px) {
                .main-content {
                    grid-template-columns: 1fr;
                }
            }

            .form-section {
                background: #f8fafc;
                border-radius: 12px;
                padding: 25px;
                margin-bottom: 25px;
                border: 1px solid #e2e8f0;
                transition:
                    transform 0.3s ease,
                    box-shadow 0.3s ease;
            }

            .form-section:hover {
                transform: translateY(-2px);
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            }

            .form-section h2 {
                color: #2d3748;
                font-size: 1.4em;
                margin-bottom: 20px;
                padding-bottom: 15px;
                border-bottom: 2px solid #667eea;
                display: flex;
                align-items: center;
                gap: 10px;
            }

            .form-section h2 i {
                color: #667eea;
            }

            .form-grid {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
                gap: 20px;
            }

            .form-group {
                margin-bottom: 20px;
            }

            .form-group label {
                display: block;
                margin-bottom: 8px;
                font-weight: 600;
                color: #4a5568;
                font-size: 0.95em;
            }

            .form-group label.required::after {
                content: " *";
                color: #e53e3e;
            }

            .form-group input,
            .form-group select {
                width: 100%;
                padding: 12px 15px;
                border: 2px solid #e2e8f0;
                border-radius: 8px;
                font-size: 15px;
                transition: all 0.3s ease;
                background: white;
            }

            .form-group input:focus,
            .form-group select:focus {
                outline: none;
                border-color: #667eea;
                box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
            }

            .file-input-container {
                margin-bottom: 25px;
            }

            .file-input-label {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 10px;
                padding: 10px 15px;
                background: #edf2f7;
                border-radius: 8px;
                cursor: pointer;
                transition: all 0.3s ease;
            }

            .file-input-label:hover {
                background: #e2e8f0;
            }

            .file-input-label h3 {
                margin: 0;
                color: #2d3748;
                font-size: 16px;
            }

            .file-count-badge {
                background: #667eea;
                color: white;
                padding: 4px 12px;
                border-radius: 20px;
                font-weight: bold;
                font-size: 12px;
                min-width: 60px;
                text-align: center;
            }

            .file-list {
                max-height: 200px;
                overflow-y: auto;
                border: 1px solid #e2e8f0;
                border-radius: 8px;
                padding: 10px;
                background: white;
                margin-top: 10px;
            }

            .file-item {
                padding: 8px 12px;
                border-bottom: 1px solid #e2e8f0;
                font-family: "Consolas", monospace;
                font-size: 13px;
                color: #4a5568;
                display: flex;
                justify-content: space-between;
                align-items: center;
            }

            .file-item:last-child {
                border-bottom: none;
            }

            .file-order {
                background: #667eea;
                color: white;
                width: 24px;
                height: 24px;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 12px;
                font-weight: bold;
            }

            .output-section {
                background: #f0f9ff;
                border-radius: 12px;
                padding: 25px;
                border: 1px solid #bee3f8;
            }

            .output-files-container {
                max-height: 400px;
                overflow-y: auto;
                margin: 20px 0;
                border: 1px solid #e2e8f0;
                border-radius: 8px;
                background: white;
            }

            .output-file-item {
                padding: 15px;
                border-bottom: 1px solid #e2e8f0;
                display: flex;
                justify-content: space-between;
                align-items: center;
                transition: background 0.3s ease;
            }

            .output-file-item:hover {
                background: #f7fafc;
            }

            .output-file-name {
                font-family: "Consolas", monospace;
                font-size: 14px;
                color: #2d3748;
            }

            .output-file-size {
                font-size: 12px;
                color: #718096;
            }

            .button-group {
                display: flex;
                gap: 15px;
                margin-top: 30px;
                flex-wrap: wrap;
            }

            button {
                padding: 14px 28px;
                border: none;
                border-radius: 8px;
                font-weight: 600;
                font-size: 15px;
                cursor: pointer;
                transition: all 0.3s ease;
                display: flex;
                align-items: center;
                gap: 8px;
            }

            .btn-primary {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
            }

            .btn-primary:hover {
                transform: translateY(-2px);
                box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
            }

            .btn-success {
                background: linear-gradient(135deg, #38a169 0%, #2f855a 100%);
                color: white;
            }

            .btn-success:hover {
                transform: translateY(-2px);
                box-shadow: 0 10px 25px rgba(56, 161, 105, 0.3);
            }

            .btn-secondary {
                background: #718096;
                color: white;
            }

            .btn-secondary:hover {
                background: #4a5568;
                transform: translateY(-2px);
            }

            .btn-danger {
                background: #e53e3e;
                color: white;
            }

            .btn-danger:hover {
                background: #c53030;
                transform: translateY(-2px);
            }

            .metadata-panel {
                background: #f8fafc;
                border-radius: 12px;
                padding: 25px;
                margin-top: 30px;
                border: 1px solid #e2e8f0;
            }

            #metadata-content {
                background: white;
                border: 1px solid #e2e8f0;
                border-radius: 8px;
                padding: 20px;
                font-family: "Consolas", monospace;
                font-size: 13px;
                max-height: 300px;
                overflow-y: auto;
                white-space: pre-wrap;
                word-wrap: break-word;
                line-height: 1.5;
            }

            .progress-container {
                background: #e6fffa;
                border-radius: 12px;
                padding: 25px;
                margin: 25px 0;
                border: 1px solid #81e6d9;
                display: none;
            }

            .progress-container.active {
                display: block;
            }

            .progress-header {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 15px;
            }

            .progress-bar {
                height: 12px;
                background: #e2e8f0;
                border-radius: 6px;
                overflow: hidden;
                margin: 15px 0;
            }

            .progress-fill {
                height: 100%;
                background: linear-gradient(90deg, #38a169, #68d391);
                width: 0%;
                transition: width 0.5s ease;
            }

            .progress-text {
                text-align: center;
                font-weight: bold;
                color: #2d3748;
                font-size: 1.1em;
                margin: 10px 0;
            }

            .status-message {
                text-align: center;
                color: #4a5568;
                font-style: italic;
                margin-top: 10px;
            }

            .alert {
                padding: 15px 20px;
                border-radius: 8px;
                margin: 15px 0;
                display: none;
                animation: slideIn 0.3s ease;
                border-left: 5px solid;
            }

            @keyframes slideIn {
                from {
                    opacity: 0;
                    transform: translateY(-10px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }

            .alert-success {
                background: #f0fff4;
                color: #22543d;
                border-left-color: #38a169;
            }

            .alert-error {
                background: #fff5f5;
                color: #742a2a;
                border-left-color: #e53e3e;
            }

            .alert-warning {
                background: #fffaf0;
                color: #744210;
                border-left-color: #ed8936;
            }

            .alert-info {
                background: #ebf8ff;
                color: #1a365d;
                border-left-color: #4299e1;
            }

            .section-header {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 20px;
            }

            .toggle-btn {
                background: none;
                border: 2px solid #667eea;
                color: #667eea;
                padding: 8px 16px;
                font-size: 14px;
            }

            .toggle-btn:hover {
                background: #667eea;
                color: white;
            }

            .validation-error {
                color: #e53e3e;
                font-size: 12px;
                margin-top: 5px;
                display: none;
            }

            input:invalid {
                border-color: #e53e3e;
            }

            .file-set-info {
                background: #edf2f7;
                padding: 15px;
                border-radius: 8px;
                margin: 15px 0;
                font-size: 14px;
            }

            .file-set-info span {
                font-weight: bold;
                color: #2d3748;
            }

            .nfrc-counter {
                display: flex;
                align-items: center;
                gap: 10px;
                background: #e6fffa;
                padding: 10px 15px;
                border-radius: 8px;
                margin-top: 15px;
                border-left: 4px solid #38a169;
            }

            .nfrc-counter label {
                font-weight: bold;
                color: #2d3748;
            }

            .nfrc-counter input {
                width: 120px;
                padding: 8px 12px;
                border: 2px solid #cbd5e0;
                border-radius: 6px;
                font-size: 14px;
            }

            .format-info {
                background: #fffaf0;
                padding: 15px;
                border-radius: 8px;
                margin: 15px 0;
                border-left: 4px solid #ed8936;
                font-size: 13px;
            }

            .format-info ul {
                margin: 10px 0;
                padding-left: 20px;
            }

            .format-info li {
                margin: 5px 0;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <header>
                <h1>Spectra Data Processor</h1>
                <p class="subtitle">
                    Merge .asc spectral files with standardized headers
                </p>
            </header>

            <div class="main-content">
                <!-- Left Column: Input Form -->
                <div>
                    <!-- Metadata Controls -->
                    <div class="section-header">
                        <h2 style="color: #2d3748; margin: 0">Configuration</h2>
                        <div>
                            <button
                                type="button"
                                class="btn-secondary toggle-btn"
                                onclick="loadDefaults()"
                            >
                                <i>‚Üª</i> Load Defaults
                            </button>
                            <button
                                type="button"
                                class="btn-secondary toggle-btn"
                                onclick="saveMetadataConfig()"
                            >
                                <i>üíæ</i> Save Config
                            </button>
                        </div>
                    </div>

                    <!-- NFRC Counter -->
                    <div class="nfrc-counter">
                        <label for="start-nfrc">Starting NFRC ID:</label>
                        <input
                            type="number"
                            id="start-nfrc"
                            value="1000"
                            min="1"
                        />
                        <span style="color: #718096; font-size: 14px"
                            >(Auto-increments +1 per file)</span
                        >
                    </div>

                    <!-- Primary Inputs -->
                    <div class="form-section">
                        <h2><i>üìã</i> Primary Inputs</h2>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="product-name" class="required"
                                    >Product Name</label
                                >
                                <input
                                    type="text"
                                    id="product-name"
                                    placeholder="Solaris_1000"
                                    value="Solaris_1000"
                                    required
                                />
                                <div
                                    class="validation-error"
                                    id="product-name-error"
                                >
                                    Product name is required
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="additional-details"
                                    >Additional Details</label
                                >
                                <input
                                    type="text"
                                    id="additional-details"
                                    placeholder="AM coating, low-E"
                                    value="AM"
                                />
                            </div>
                            <div class="form-group">
                                <label for="thickness" class="required"
                                    >Thickness (mm)</label
                                >
                                <input
                                    type="number"
                                    id="thickness"
                                    step="0.01"
                                    value="11.00"
                                    required
                                />
                                <div
                                    class="validation-error"
                                    id="thickness-error"
                                >
                                    Thickness is required
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="emissivity-back" class="required"
                                    >Emissivity Back</label
                                >
                                <input
                                    type="number"
                                    id="emissivity-back"
                                    step="0.000001"
                                    value="0.001234"
                                    required
                                />
                                <div
                                    class="validation-error"
                                    id="emissivity-back-error"
                                >
                                    Emissivity back is required
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="appearance" class="required"
                                    >Appearance</label
                                >
                                <input
                                    type="text"
                                    id="appearance"
                                    placeholder="Clear"
                                    value="Clear"
                                    required
                                />
                                <div
                                    class="validation-error"
                                    id="appearance-error"
                                >
                                    Appearance is required
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="substrate-filename" class="required"
                                    >Substrate Filename</label
                                >
                                <input
                                    type="text"
                                    id="substrate-filename"
                                    placeholder="substrate.txt"
                                    value="substrate.txt"
                                    required
                                />
                                <div
                                    class="validation-error"
                                    id="substrate-filename-error"
                                >
                                    Substrate filename is required
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Secondary Inputs -->
                    <div class="form-section">
                        <h2><i>‚öôÔ∏è</i> Secondary Inputs</h2>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="wavelength">Wavelength Units</label>
                                <input
                                    type="text"
                                    id="wavelength"
                                    value="SI Microns"
                                />
                            </div>
                            <div class="form-group">
                                <label for="conductivity">Conductivity</label>
                                <input
                                    type="number"
                                    id="conductivity"
                                    step="0.000001"
                                    value="0.0"
                                />
                            </div>
                            <div class="form-group">
                                <label for="ir-transmittance"
                                    >IR Transmittance</label
                                >
                                <input
                                    type="number"
                                    id="ir-transmittance"
                                    step="0.000001"
                                    value="0.0123"
                                />
                            </div>
                            <div class="form-group">
                                <label for="emissivity-front"
                                    >Emissivity Front</label
                                >
                                <input
                                    type="number"
                                    id="emissivity-front"
                                    step="0.000001"
                                    value="0.00123"
                                />
                            </div>
                            <div class="form-group">
                                <label for="manufacturer">Manufacturer</label>
                                <input
                                    type="text"
                                    id="manufacturer"
                                    value="AIS"
                                />
                            </div>
                            <div class="form-group">
                                <label for="type">Type</label>
                                <input type="text" id="type" value="type" />
                            </div>
                            <div class="form-group">
                                <label for="material">Material</label>
                                <input type="text" id="material" value="N/A" />
                            </div>
                            <div class="form-group">
                                <label for="coated-side">Coated Side</label>
                                <select id="coated-side">
                                    <option value="front">Front</option>
                                    <option value="back">Back</option>
                                    <option value="both">Both</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- File Uploads -->
                    <div class="form-section">
                        <h2><i>üìÅ</i> File Inputs</h2>

                        <!-- Directory 1 -->
                        <div class="file-input-container">
                            <label
                                class="file-input-label"
                                onclick="document.getElementById('dir1-files').click()"
                            >
                                <h3>Directory 1 (.asc files)</h3>
                                <span id="dir1-count" class="file-count-badge"
                                    >0 files</span
                                >
                            </label>
                            <input
                                type="file"
                                id="dir1-files"
                                multiple
                                accept=".asc"
                                style="display: none"
                                onchange="handleFileSelect('dir1', this.files)"
                            />
                            <div id="dir1-list" class="file-list">
                                <div
                                    style="
                                        text-align: center;
                                        padding: 20px;
                                        color: #718096;
                                    "
                                >
                                    No files selected
                                </div>
                            </div>
                        </div>

                        <!-- Directory 2 -->
                        <div class="file-input-container">
                            <label
                                class="file-input-label"
                                onclick="document.getElementById('dir2-files').click()"
                            >
                                <h3>Directory 2 (.asc files)</h3>
                                <span id="dir2-count" class="file-count-badge"
                                    >0 files</span
                                >
                            </label>
                            <input
                                type="file"
                                id="dir2-files"
                                multiple
                                accept=".asc"
                                style="display: none"
                                onchange="handleFileSelect('dir2', this.files)"
                            />
                            <div id="dir2-list" class="file-list">
                                <div
                                    style="
                                        text-align: center;
                                        padding: 20px;
                                        color: #718096;
                                    "
                                >
                                    No files selected
                                </div>
                            </div>
                        </div>

                        <!-- Directory 3 -->
                        <div class="file-input-container">
                            <label
                                class="file-input-label"
                                onclick="document.getElementById('dir3-files').click()"
                            >
                                <h3>Directory 3 (.asc files)</h3>
                                <span id="dir3-count" class="file-count-badge"
                                    >0 files</span
                                >
                            </label>
                            <input
                                type="file"
                                id="dir3-files"
                                multiple
                                accept=".asc"
                                style="display: none"
                                onchange="handleFileSelect('dir3', this.files)"
                            />
                            <div id="dir3-list" class="file-list">
                                <div
                                    style="
                                        text-align: center;
                                        padding: 20px;
                                        color: #718096;
                                    "
                                >
                                    No files selected
                                </div>
                            </div>
                        </div>

                        <!-- Metadata File -->
                        <div class="file-input-container">
                            <label
                                class="file-input-label"
                                onclick="document.getElementById('metadata-file').click()"
                            >
                                <h3>Load Metadata JSON</h3>
                                <span
                                    id="metadata-count"
                                    class="file-count-badge"
                                    >No file</span
                                >
                            </label>
                            <input
                                type="file"
                                id="metadata-file"
                                accept=".json"
                                style="display: none"
                                onchange="handleMetadataSelect(this.files)"
                            />
                        </div>

                        <!-- Format Info -->
                        <div class="format-info">
                            <strong>Output Format Specifications:</strong>
                            <ul>
                                <li>
                                    Column 1 (wavelength/1000): 3 significant
                                    figures, filtered from 320 to 2500 nm
                                </li>
                                <li>
                                    Columns 2-4 (data/100): 8 significant
                                    figures
                                </li>
                                <li>
                                    Data reversed: 2500‚Üí250 nm (output shows
                                    250‚Üí2500)
                                </li>
                                <li>All outputs packaged in single ZIP file</li>
                            </ul>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="button-group">
                        <button
                            type="button"
                            class="btn-primary"
                            onclick="processAllFiles()"
                        >
                            <i>‚ö°</i> Process Files
                        </button>
                        <button
                            type="button"
                            class="btn-success"
                            id="download-all-btn"
                            onclick="downloadAllFilesAsZip()"
                            disabled
                        >
                            <i>üì¶</i> Download ZIP
                        </button>
                        <button
                            type="button"
                            class="btn-danger"
                            onclick="resetAll()"
                        >
                            <i>üóëÔ∏è</i> Reset All
                        </button>
                    </div>
                </div>

                <!-- Right Column: Output & Progress -->
                <div>
                    <!-- Progress Container -->
                    <div class="progress-container" id="progress-container">
                        <div class="progress-header">
                            <h3 style="color: #2d3748; margin: 0">
                                Processing Progress
                            </h3>
                            <span id="progress-percent">0%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="progress-fill"></div>
                        </div>
                        <div class="progress-text" id="progress-text">
                            Ready
                        </div>
                        <div class="status-message" id="status-message">
                            Waiting for files...
                        </div>
                    </div>

                    <!-- Alerts -->
                    <div id="alert-container"></div>

                    <!-- Output Files -->
                    <div class="output-section">
                        <h2><i>üìä</i> Output Files</h2>

                        <div class="file-set-info" id="file-set-info">
                            <div>
                                <strong>Ready to process:</strong>
                                <span id="total-sets">0</span> file sets
                            </div>
                            <div>
                                NFRC IDs: <span id="nfrc-range">1000-1000</span>
                            </div>
                            <div>
                                Wavelength range: 320‚Üí2500 nm (excluding
                                250-315)
                            </div>
                            <div>
                                Output format: Col1(3 sigfig), Col2-4(8 sigfig)
                            </div>
                        </div>

                        <div
                            class="output-files-container"
                            id="output-files-container"
                        >
                            <div
                                style="
                                    text-align: center;
                                    padding: 40px;
                                    color: #718096;
                                "
                            >
                                <div
                                    style="font-size: 48px; margin-bottom: 20px"
                                >
                                    üì¶
                                </div>
                                <p>Processed files will appear here</p>
                                <p style="font-size: 14px; margin-top: 10px">
                                    All files will be packaged in a single ZIP
                                </p>
                            </div>
                        </div>

                        <div class="button-group" style="margin-top: 20px">
                            <button
                                type="button"
                                class="btn-secondary"
                                onclick="clearOutput()"
                            >
                                <i>üóëÔ∏è</i> Clear Output
                            </button>
                            <button
                                type="button"
                                class="btn-secondary"
                                onclick="showProcessingInfo()"
                            >
                                <i>‚ÑπÔ∏è</i> Processing Info
                            </button>
                        </div>
                    </div>

                    <!-- Metadata Display -->
                    <div class="metadata-panel">
                        <div class="section-header">
                            <h3 style="color: #2d3748; margin: 0">
                                Current Metadata
                            </h3>
                            <button
                                type="button"
                                class="toggle-btn"
                                onclick="refreshMetadata()"
                            >
                                <i>‚Üª</i> Refresh
                            </button>
                        </div>
                        <pre id="metadata-content">
{
  "Product_Name": "Solaris_1000",
  "Additional_Details": "AM",
  "Thickness": 11.0,
  "Emissivity_back": 0.001234,
  "Appearance": "Clear",
  "NFRC_id": 1000,
  "Substrate_filename": "substrate.txt",
  "Wavelength": "SI Microns",
  "Conductivity": 0.0,
  "IR_Transmittance": 0.0123,
  "Emissivity_front": 0.00123,
  "Manufacturer": "AIS",
  "Type": "type",
  "Material": "N/A",
  "Coated_Side": "front"
}</pre
                        >
                    </div>
                </div>
            </div>
        </div>

        <script>
            // Global state
            const state = {
                metadata: getDefaultMetadata(),
                files: {
                    dir1: [],
                    dir2: [],
                    dir3: [],
                },
                outputFiles: [],
                processing: false,
                currentNfrcId: 1000,
            };

            // Initialize
            document.addEventListener("DOMContentLoaded", function () {
                setupFormListeners();
                updateMetadataDisplay();
                updateNfrcRange();
            });

            function getDefaultMetadata() {
                return {
                    Product_Name: "Solaris_1000",
                    Additional_Details: "AM",
                    Thickness: 11.0,
                    Emissivity_back: 0.001234,
                    Appearance: "Clear",
                    NFRC_id: 1000,
                    Substrate_filename: "substrate.txt",
                    Wavelength: "SI Microns",
                    Conductivity: 0.0,
                    IR_Transmittance: 0.0123,
                    Emissivity_front: 0.00123,
                    Manufacturer: "AIS",
                    Type: "type",
                    Material: "N/A",
                    Coated_Side: "front",
                };
            }

            function setupFormListeners() {
                // Auto-populate form with defaults
                populateFormWithMetadata();

                // Add input listeners
                const inputs = [
                    "product-name",
                    "additional-details",
                    "thickness",
                    "emissivity-back",
                    "appearance",
                    "substrate-filename",
                    "wavelength",
                    "conductivity",
                    "ir-transmittance",
                    "emissivity-front",
                    "manufacturer",
                    "type",
                    "material",
                    "coated-side",
                ];

                inputs.forEach((id) => {
                    document
                        .getElementById(id)
                        .addEventListener("input", updateMetadataFromForm);
                });

                // Listen for start NFRC ID changes
                document
                    .getElementById("start-nfrc")
                    .addEventListener("input", function () {
                        updateNfrcRange();
                    });
            }

            function populateFormWithMetadata() {
                document.getElementById("product-name").value =
                    state.metadata.Product_Name;
                document.getElementById("additional-details").value =
                    state.metadata.Additional_Details;
                document.getElementById("thickness").value =
                    state.metadata.Thickness;
                document.getElementById("emissivity-back").value =
                    state.metadata.Emissivity_back;
                document.getElementById("appearance").value =
                    state.metadata.Appearance;
                document.getElementById("substrate-filename").value =
                    state.metadata.Substrate_filename;
                document.getElementById("wavelength").value =
                    state.metadata.Wavelength;
                document.getElementById("conductivity").value =
                    state.metadata.Conductivity;
                document.getElementById("ir-transmittance").value =
                    state.metadata.IR_Transmittance;
                document.getElementById("emissivity-front").value =
                    state.metadata.Emissivity_front;
                document.getElementById("manufacturer").value =
                    state.metadata.Manufacturer;
                document.getElementById("type").value = state.metadata.Type;
                document.getElementById("material").value =
                    state.metadata.Material;
                document.getElementById("coated-side").value =
                    state.metadata.Coated_Side;
            }

            function updateMetadataFromForm() {
                state.metadata = {
                    Product_Name: document.getElementById("product-name").value,
                    Additional_Details:
                        document.getElementById("additional-details").value,
                    Thickness:
                        parseFloat(
                            document.getElementById("thickness").value,
                        ) || 0,
                    Emissivity_back:
                        parseFloat(
                            document.getElementById("emissivity-back").value,
                        ) || 0,
                    Appearance: document.getElementById("appearance").value,
                    Substrate_filename:
                        document.getElementById("substrate-filename").value,
                    Wavelength: document.getElementById("wavelength").value,
                    Conductivity:
                        parseFloat(
                            document.getElementById("conductivity").value,
                        ) || 0,
                    IR_Transmittance:
                        parseFloat(
                            document.getElementById("ir-transmittance").value,
                        ) || 0,
                    Emissivity_front:
                        parseFloat(
                            document.getElementById("emissivity-front").value,
                        ) || 0,
                    Manufacturer: document.getElementById("manufacturer").value,
                    Type: document.getElementById("type").value,
                    Material: document.getElementById("material").value,
                    Coated_Side: document.getElementById("coated-side").value,
                };

                updateMetadataDisplay();
            }

            function updateMetadataDisplay() {
                const display = document.getElementById("metadata-content");
                display.textContent = JSON.stringify(state.metadata, null, 2);
            }

            function handleFileSelect(dirName, files) {
                const ascFiles = Array.from(files).filter((file) =>
                    file.name.toLowerCase().endsWith(".asc"),
                );

                // Sort files by name to ensure proper ordering
                ascFiles.sort((a, b) => {
                    // Extract numeric parts from filenames
                    const numA = extractNumber(a.name);
                    const numB = extractNumber(b.name);
                    return numA - numB;
                });

                state.files[dirName] = ascFiles;

                // Update display
                updateFileDisplay(dirName, ascFiles);
                updateFileSetInfo();
            }

            function extractNumber(filename) {
                // Extract numbers from filename
                const matches = filename.match(/\d+/g);
                return matches ? parseInt(matches.join("")) : 0;
            }

            function updateFileDisplay(dirName, files) {
                const countElement = document.getElementById(
                    `${dirName}-count`,
                );
                const listElement = document.getElementById(`${dirName}-list`);

                countElement.textContent = `${files.length} file${files.length !== 1 ? "s" : ""}`;
                countElement.style.background =
                    files.length > 0 ? "#38a169" : "#667eea";

                if (files.length > 0) {
                    let html = "";
                    files.forEach((file, index) => {
                        html += `
                        <div class="file-item">
                            <div>
                                <span class="file-order">${index + 1}</span>
                                ${file.name}
                            </div>
                            <span style="color: #718096; font-size: 11px;">
                                ${formatFileSize(file.size)}
                            </span>
                        </div>
                    `;
                    });
                    listElement.innerHTML = html;
                } else {
                    listElement.innerHTML = `
                    <div style="text-align: center; padding: 20px; color: #718096;">
                        No files selected
                    </div>
                `;
                }
            }

            function formatFileSize(bytes) {
                if (bytes < 1024) return bytes + " B";
                if (bytes < 1024 * 1024)
                    return (bytes / 1024).toFixed(1) + " KB";
                return (bytes / (1024 * 1024)).toFixed(1) + " MB";
            }

            function updateFileSetInfo() {
                const counts = [
                    state.files.dir1.length,
                    state.files.dir2.length,
                    state.files.dir3.length,
                ];

                const minCount = Math.min(...counts);
                const totalSets = minCount;

                document.getElementById("total-sets").textContent = totalSets;
                updateNfrcRange();
            }

            function updateNfrcRange() {
                const startNfrc =
                    parseInt(document.getElementById("start-nfrc").value) ||
                    1000;
                const counts = [
                    state.files.dir1.length,
                    state.files.dir2.length,
                    state.files.dir3.length,
                ];
                const minCount = Math.min(...counts);
                const endNfrc = startNfrc + minCount - 1;

                if (minCount > 0) {
                    document.getElementById("nfrc-range").textContent =
                        `${startNfrc}-${endNfrc} (${minCount} files, +1 each)`;
                } else {
                    document.getElementById("nfrc-range").textContent =
                        `${startNfrc}-${startNfrc}`;
                }
            }

            function handleMetadataSelect(files) {
                if (files.length === 0) return;

                const file = files[0];
                const reader = new FileReader();

                reader.onload = function (e) {
                    try {
                        const loadedMetadata = JSON.parse(e.target.result);

                        // Merge with current metadata
                        state.metadata = {
                            ...state.metadata,
                            ...loadedMetadata,
                        };

                        // Update form and display
                        populateFormWithMetadata();
                        updateMetadataDisplay();

                        document.getElementById("metadata-count").textContent =
                            "Loaded";
                        document.getElementById(
                            "metadata-count",
                        ).style.background = "#38a169";

                        showAlert("Metadata loaded successfully", "success");
                    } catch (error) {
                        document.getElementById("metadata-count").textContent =
                            "Error";
                        document.getElementById(
                            "metadata-count",
                        ).style.background = "#e53e3e";
                        showAlert(
                            "Error parsing metadata file: " + error.message,
                            "error",
                        );
                    }
                };

                reader.readAsText(file);
            }

            async function processAllFiles() {
                if (state.processing) {
                    showAlert("Processing already in progress", "warning");
                    return;
                }

                try {
                    // Validate inputs
                    if (!validateForm()) {
                        return;
                    }

                    // Get file counts
                    const counts = [
                        state.files.dir1.length,
                        state.files.dir2.length,
                        state.files.dir3.length,
                    ];

                    const minCount = Math.min(...counts);

                    if (minCount === 0) {
                        showAlert(
                            "Each directory must contain at least one .asc file",
                            "error",
                        );
                        return;
                    }

                    // Check for matching counts
                    const maxCount = Math.max(...counts);
                    if (minCount !== maxCount) {
                        const proceed = confirm(
                            `Warning: Directory file counts differ (${counts.join(", ")}).\nWill process ${minCount} sets. Continue?`,
                        );
                        if (!proceed) return;
                    }

                    // Get starting NFRC ID
                    const startNfrc =
                        parseInt(document.getElementById("start-nfrc").value) ||
                        1000;
                    state.currentNfrcId = startNfrc;

                    // Start processing
                    state.processing = true;
                    state.outputFiles = [];

                    showProgress(true);
                    clearOutput();

                    // Process each file set
                    for (let i = 0; i < minCount; i++) {
                        updateProgress(
                            (i / minCount) * 100,
                            `Processing set ${i + 1} of ${minCount}...`,
                        );

                        try {
                            // Get file set
                            const fileSet = [
                                state.files.dir1[i],
                                state.files.dir2[i],
                                state.files.dir3[i],
                            ];

                            // Process this set with current NFRC ID
                            const result = await processFileSet(fileSet, i);
                            state.outputFiles.push(result);

                            // Add to output display
                            addOutputFile(result);

                            // Increment NFRC ID for next file
                            state.currentNfrcId++;
                        } catch (error) {
                            showAlert(
                                `Error processing set ${i + 1}: ${error.message}`,
                                "error",
                            );
                        }
                    }

                    updateProgress(100, "Processing complete!");
                    showAlert(
                        `Successfully processed ${state.outputFiles.length} file sets. Ready to download ZIP.`,
                        "success",
                    );

                    // Enable download button
                    document.getElementById("download-all-btn").disabled =
                        false;
                } catch (error) {
                    showAlert("Processing error: " + error.message, "error");
                } finally {
                    state.processing = false;
                    setTimeout(() => showProgress(false), 2000);
                }
            }

            function validateForm() {
                let isValid = true;

                const requiredFields = [
                    { id: "product-name", name: "Product Name" },
                    { id: "thickness", name: "Thickness" },
                    { id: "emissivity-back", name: "Emissivity Back" },
                    { id: "appearance", name: "Appearance" },
                    { id: "substrate-filename", name: "Substrate Filename" },
                ];

                requiredFields.forEach((field) => {
                    const element = document.getElementById(field.id);
                    const errorElement = document.getElementById(
                        `${field.id}-error`,
                    );

                    if (!element.value.trim()) {
                        errorElement.style.display = "block";
                        isValid = false;
                    } else {
                        errorElement.style.display = "none";
                    }
                });

                return isValid;
            }

            async function processFileSet(fileSet, index) {
                // Read all files
                const fileContents = await Promise.all(
                    fileSet.map((file) => readFileAsText(file)),
                );

                // Parse ASC data
                const parsedData = fileContents.map((content) =>
                    parseASCFile(content),
                );

                // Set NFRC ID for this file
                state.metadata.NFRC_id = state.currentNfrcId;

                // Generate filename exactly as specified
                const filename = generateOutputFilename(index);

                // Create merged content with exact format
                const content = createMergedFile(parsedData, filename);

                return {
                    filename: filename,
                    content: content,
                    nfrcId: state.currentNfrcId,
                    timestamp: new Date().toISOString(),
                    sourceFiles: fileSet.map((f) => f.name),
                };
            }

            function readFileAsText(file) {
                return new Promise((resolve, reject) => {
                    const reader = new FileReader();
                    reader.onload = (e) => resolve(e.target.result);
                    reader.onerror = (e) =>
                        reject(new Error(`Failed to read file: ${file.name}`));
                    reader.readAsText(file);
                });
            }

            function parseASCFile(content) {
                const lines = content.split("\n");
                let inDataSection = false;
                const data = [];

                for (const line of lines) {
                    const trimmedLine = line.trim();

                    if (trimmedLine.startsWith("#DATA")) {
                        inDataSection = true;
                        continue;
                    }

                    if (
                        inDataSection &&
                        trimmedLine &&
                        !trimmedLine.startsWith("#")
                    ) {
                        const parts = trimmedLine
                            .split(/\s+/)
                            .filter((p) => p.length > 0);

                        if (parts.length >= 2) {
                            const wavelength = parseFloat(parts[0]);
                            const measurement = parseFloat(parts[1]);

                            if (!isNaN(wavelength) && !isNaN(measurement)) {
                                data.push({
                                    wavelength: wavelength,
                                    measurement: measurement,
                                });
                            }
                        }
                    }
                }

                if (data.length === 0) {
                    throw new Error("No valid data found in ASC file");
                }

                return data;
            }

            function generateOutputFilename(index) {
                const nfrcId = state.currentNfrcId;
                const productName = (
                    state.metadata.Product_Name || "product"
                ).split("_")[0];
                const thickness = state.metadata.Thickness || 0;
                const additional = state.metadata.Additional_Details || "";

                // Clean additional details for filename (exactly as specified)
                const cleanAdditional = additional
                    .replace(/[^a-zA-Z0-9]/g, "_") // Replace non-alphanumeric with _
                    .replace(/_{2,}/g, "_") // Replace multiple __ with single _
                    .trim("_"); // Remove leading/trailing _

                let filename = `${nfrcId}_${productName}_${thickness}mm`;

                if (cleanAdditional) {
                    filename += `_${cleanAdditional}`;
                }

                return filename + ".txt";
            }

            function createMergedFile(parsedData, filename) {
                const header = createHeader(filename);
                const dataLines = mergeDataLines(parsedData);

                return header + "\n" + dataLines.join("\n");
            }

            function createHeader(filename) {
                // Calculate checksum as specified
                const checksum = (
                    (state.metadata.Emissivity_front || 0) +
                    (state.metadata.Emissivity_back || 0)
                ).toFixed(6);

                // Create coating name exactly as specified
                const coatingName = `${state.metadata.NFRC_id || ""}_${
                    (state.metadata.Product_Name || "").split("_")[0] ||
                    "product"
                }_${state.metadata.Thickness || 0}mm_${state.metadata.Additional_Details || ""}`;

                // Build header exactly as specified
                return `{ Units Wavelength Units } ${state.metadata.Wavelength || "SI Microns"}
{ Thickness } ${state.metadata.Thickness || 0}
{ Conductivity } ${state.metadata.Conductivity || 0.0}
{ IR Transmittance } TIR=${state.metadata.IR_Transmittance || 0.0123}
{ Emissivity front back } Emis= ${state.metadata.Emissivity_front || 0.00123} ${state.metadata.Emissivity_back || 0.001234}
{ Ef_Source: Text Files }
{ Eb_Source: Text Files }
{ IGDB_Checksum: ${checksum} }
{ Product Name: ${filename} }
{ Manufacturer: ${state.metadata.Manufacturer || "AIS"} }
{ NFRC ID: ${state.metadata.NFRC_id || 0} }
{ Type: ${state.metadata.Type || "type"} }
{ Material: ${state.metadata.Material || "N/A"} }
{ Coating Name: ${coatingName} }
{ Coated Side: ${state.metadata.Coated_Side || "front"} }
{ Substrate Filename: ${state.metadata.Substrate_filename || ""} }
{ Appearance: ${state.metadata.Appearance || ""} }
{ Acceptance: # }
{ Uses: Glass }
{ Availability: X }
{ Structure: }`;
            }

            function mergeDataLines(parsedData) {
                // Use the first file as reference for wavelength points
                const referenceData = parsedData[0];
                const dataLines = [];

                // Process data in reverse order (250‚Üí2500) and filter wavelengths
                for (let i = referenceData.length - 1; i >= 0; i--) {
                    const wavelength = referenceData[i].wavelength;

                    // FILTER: Only include wavelengths from 320 to 2500 nm (ignore 250-315)
                    if (wavelength >= 320 && wavelength <= 2500) {
                        const values = [];

                        // Column 1: wavelength/1000 with 3 significant figures
                        const col1Value = wavelength / 1000;
                        values.push(formatSignificantFigures(col1Value, 3));

                        // Columns 2-4: measurements/100 with 8 significant figures
                        for (let j = 0; j < 3; j++) {
                            if (parsedData[j] && parsedData[j][i]) {
                                const colValue =
                                    parsedData[j][i].measurement / 100;
                                values.push(
                                    formatSignificantFigures(colValue, 8),
                                );
                            } else {
                                values.push(formatSignificantFigures(0, 8));
                            }
                        }

                        dataLines.push(values.join(" "));
                    }
                }

                return dataLines;
            }

            function formatSignificantFigures(value, sigFigs) {
                if (value === 0) return "0." + "0".repeat(sigFigs - 1);

                const magnitude = Math.floor(Math.log10(Math.abs(value)));
                const scale = Math.pow(10, sigFigs - 1 - magnitude);
                const rounded = Math.round(value * scale) / scale;

                // Format with appropriate decimal places
                if (magnitude >= sigFigs - 1) {
                    // Integer formatting
                    return rounded.toFixed(0);
                } else if (magnitude >= 0) {
                    // Mixed number formatting
                    return rounded.toFixed(sigFigs - magnitude - 1);
                } else {
                    // Decimal formatting
                    return rounded.toFixed(sigFigs - 1 - magnitude);
                }
            }

            function addOutputFile(file) {
                const container = document.getElementById(
                    "output-files-container",
                );

                // Remove placeholder if present
                if (
                    container.children.length === 1 &&
                    container.children[0].querySelector("p")
                ) {
                    container.innerHTML = "";
                }

                const fileItem = document.createElement("div");
                fileItem.className = "output-file-item";

                fileItem.innerHTML = `
                <div>
                    <div class="output-file-name">${file.filename}</div>
                    <div class="output-file-size">NFRC: ${file.nfrcId} | ${Math.round((file.content.length / 1024) * 10) / 10} KB</div>
                </div>
            `;

                container.appendChild(fileItem);
            }

            function downloadAllFilesAsZip() {
                if (state.outputFiles.length === 0) {
                    showAlert("No files to download", "warning");
                    return;
                }

                try {
                    // Create a zip file
                    const zip = new JSZip();

                    // Add all output files to zip
                    state.outputFiles.forEach((file) => {
                        zip.file(file.filename, file.content);
                    });

                    // Add a readme file with processing info
                    const readmeContent = createReadmeFile();
                    zip.file("README.txt", readmeContent);

                    // Generate and download zip
                    zip.generateAsync({ type: "blob" })
                        .then(function (content) {
                            const timestamp = new Date()
                                .toISOString()
                                .replace(/[:.]/g, "-")
                                .split("T")[0];
                            const zipFilename = `processed_spectra_${timestamp}.zip`;

                            saveAs(content, zipFilename);
                            showAlert(
                                `ZIP file downloaded: ${zipFilename} (${state.outputFiles.length} files)`,
                                "success",
                            );
                        })
                        .catch((error) => {
                            showAlert(
                                "Error creating ZIP file: " + error.message,
                                "error",
                            );
                        });
                } catch (error) {
                    showAlert(
                        "Error preparing ZIP download: " + error.message,
                        "error",
                    );
                }
            }

            function createReadmeFile() {
                const startNfrc =
                    parseInt(document.getElementById("start-nfrc").value) ||
                    1000;
                const counts = [
                    state.files.dir1.length,
                    state.files.dir2.length,
                    state.files.dir3.length,
                ];
                const minCount = Math.min(...counts);

                return `SPECTRA DATA PROCESSING OUTPUT
================================

Processing Date: ${new Date().toISOString()}
Total Files Processed: ${state.outputFiles.length}
NFRC ID Range: ${startNfrc} - ${startNfrc + minCount - 1}

INPUT CONFIGURATION:
-------------------
Product Name: ${state.metadata.Product_Name}
Additional Details: ${state.metadata.Additional_Details}
Thickness: ${state.metadata.Thickness} mm
Appearance: ${state.metadata.Appearance}
Manufacturer: ${state.metadata.Manufacturer}

PROCESSING PARAMETERS:
---------------------
1. NFRC ID Auto-increment: Each file +1
2. Wavelength Filtering: 320-2500 nm (250-315 excluded)
3. Data Reversal: 250‚Üí2500 nm (ascending order)
4. Significant Figures:
   - Column 1 (wavelength): 3 sig figs
   - Columns 2-4 (measurements): 8 sig figs

OUTPUT FILES:
------------
${state.outputFiles.map((f) => `${f.filename} (NFRC: ${f.nfrcId})`).join("\n")}

PROCESSING NOTES:
---------------
- Each output file merges 3 input files (one from each directory)
- Data columns: wavelength/1000 measurement1/100 measurement2/100 measurement3/100
- All files follow standardized header format
- Total rows per file: Varies based on filtered wavelength range`;
            }

            function showProgress(show) {
                const container = document.getElementById("progress-container");
                if (show) {
                    container.classList.add("active");
                } else {
                    container.classList.remove("active");
                }
            }

            function updateProgress(percent, message) {
                document.getElementById("progress-fill").style.width =
                    `${percent}%`;
                document.getElementById("progress-percent").textContent =
                    `${Math.round(percent)}%`;
                document.getElementById("progress-text").textContent =
                    `${Math.round(percent)}% Complete`;
                document.getElementById("status-message").textContent = message;
            }

            function showAlert(message, type = "info") {
                const container = document.getElementById("alert-container");

                const alert = document.createElement("div");
                alert.className = `alert alert-${type}`;
                alert.textContent = message;
                alert.style.display = "block";

                container.appendChild(alert);

                // Auto-remove after 5 seconds
                setTimeout(() => {
                    alert.style.opacity = "0";
                    alert.style.transition = "opacity 0.5s ease";
                    setTimeout(() => alert.remove(), 500);
                }, 5000);
            }

            function loadDefaults() {
                state.metadata = getDefaultMetadata();
                populateFormWithMetadata();
                updateMetadataDisplay();
                showAlert("Default metadata loaded", "success");
            }

            function saveMetadataConfig() {
                updateMetadataFromForm();

                const config = {
                    ...state.metadata,
                    timestamp: new Date().toISOString(),
                    version: "1.0",
                };

                const content = JSON.stringify(config, null, 2);

                // Download as JSON file
                const blob = new Blob([content], { type: "application/json" });
                const url = URL.createObjectURL(blob);
                const link = document.createElement("a");
                link.href = url;
                link.download = "spectra_config.json";
                link.click();
                URL.revokeObjectURL(url);
            }

            function refreshMetadata() {
                updateMetadataFromForm();
                showAlert("Metadata refreshed from form", "info");
            }

            function clearOutput() {
                state.outputFiles = [];
                document.getElementById("output-files-container").innerHTML = `
                <div style="text-align: center; padding: 40px; color: #718096;">
                    <div style="font-size: 48px; margin-bottom: 20px;">üì¶</div>
                    <p>Processed files will appear here</p>
                    <p style="font-size: 14px; margin-top: 10px;">All files will be packaged in a single ZIP</p>
                </div>
            `;
                document.getElementById("download-all-btn").disabled = true;
            }

            function resetAll() {
                if (
                    !confirm(
                        "Are you sure you want to reset everything? All data will be lost.",
                    )
                ) {
                    return;
                }

                // Reset metadata
                state.metadata = getDefaultMetadata();
                populateFormWithMetadata();
                updateMetadataDisplay();

                // Reset files
                state.files = { dir1: [], dir2: [], dir3: [] };

                // Reset file displays
                ["dir1", "dir2", "dir3"].forEach((dir) => {
                    document.getElementById(`${dir}-count`).textContent =
                        "0 files";
                    document.getElementById(`${dir}-count`).style.background =
                        "#667eea";
                    document.getElementById(`${dir}-list`).innerHTML = `
                    <div style="text-align: center; padding: 20px; color: #718096;">
                        No files selected
                    </div>
                `;
                    document.getElementById(`${dir}-files`).value = "";
                });

                document.getElementById("metadata-count").textContent =
                    "No file";
                document.getElementById("metadata-count").style.background =
                    "#667eea";
                document.getElementById("metadata-file").value = "";

                // Reset output
                clearOutput();
                updateFileSetInfo();

                // Reset NFRC ID
                document.getElementById("start-nfrc").value = 1000;
                state.currentNfrcId = 1000;
                updateNfrcRange();

                showAlert("All data has been reset", "success");
            }

            function showProcessingInfo() {
                const counts = [
                    state.files.dir1.length,
                    state.files.dir2.length,
                    state.files.dir3.length,
                ];
                const minCount = Math.min(...counts);
                const startNfrc =
                    parseInt(document.getElementById("start-nfrc").value) ||
                    1000;

                const info = `PROCESSING INFORMATION:
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

FILE ARRANGEMENT:
‚Ä¢ Directory 1: ${state.files.dir1.length} files (sorted by name)
‚Ä¢ Directory 2: ${state.files.dir2.length} files (sorted by name)
‚Ä¢ Directory 3: ${state.files.dir3.length} files (sorted by name)
‚Ä¢ Processing order: File 1 from each dir, then File 2, etc.

DATA PROCESSING:
1. Wavelength Filtering:
   ‚Ä¢ Input range: Typically 250-2500 nm
   ‚Ä¢ Output range: 320-2500 nm only
   ‚Ä¢ Excluded: 250-315 nm range

2. Format Specifications:
   ‚Ä¢ Column 1 (wavelength/1000): 3 significant figures
   ‚Ä¢ Column 2 (data1/100): 8 significant figures
   ‚Ä¢ Column 3 (data2/100): 8 significant figures
   ‚Ä¢ Column 4 (data3/100): 8 significant figures

3. Output Order:
   ‚Ä¢ Data reversed: 2500‚Üí250 ‚Üí 250‚Üí2500
   ‚Ä¢ Ascending wavelength order
   ‚Ä¢ Filtered to 320-2500 nm

4. NFRC ID Management:
   ‚Ä¢ Starting NFRC: ${startNfrc}
   ‚Ä¢ Auto-increment: +1 per file
   ‚Ä¢ Final NFRC: ${startNfrc + minCount - 1}

OUTPUT PACKAGING:
‚Ä¢ All files bundled in single ZIP
‚Ä¢ Includes README.txt with processing details
‚Ä¢ Preserves original sorting order`;

                alert(info);
            }
        </script>
        <!-- Include JSZip and FileSaver libraries -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    </body>
</html>
